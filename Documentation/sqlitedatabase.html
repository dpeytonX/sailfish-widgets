<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html>
<html lang="en">
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<!-- sqlitedatabase.cpp -->
  <title>SQLiteDatabase Class | Safilfish Widgets 1.4</title>
</head>
<body>
<link rel='stylesheet' href='style/stylesheet.css' /> <h2>Back to <a href='https://github.com/prplmnky/sailfish-widgets'>GitHub</a></h2><li>SQLiteDatabase</li>
<div class="sidebar">
<div class="toc">
<h3><a name="toc">Contents</a></h3>
<ul>
<li class="level1"><a href="#public-functions">Public Functions</a></li>
<li class="level1"><a href="#signals">Signals</a></li>
<li class="level1"><a href="#details">Detailed Description</a></li>
</ul>
</div>
<div class="sidebar-content" id="sidebar-content"></div></div>
<h1 class="title">SQLiteDatabase Class</h1>
<!-- $$$SQLiteDatabase-brief -->
<p>The <a href="sqlitedatabase.html">SQLiteDatabase</a> class <a href="#details">More...</a></p>
<!-- @@@SQLiteDatabase -->
<div class="table"><table class="alignedsummary">
<tr><td class="memItemLeft rightAlign topAlign"> Header:</td><td class="memItemRight bottomAlign"> <span class="preprocessor">#include &lt;SQLiteDatabase&gt;</span>
</td></tr><tr><td class="memItemLeft rightAlign topAlign"> Since:</td><td class="memItemRight bottomAlign">  Qt 5.0</td></tr><tr><td class="memItemLeft rightAlign topAlign"> Inherits:</td><td class="memItemRight bottomAlign"> </td></tr></table></div><ul>
<li><a href="sqlitedatabase-members.html">List of all members, including inherited members</a></li>
</ul>
<a name="public-functions"></a>
<h2 id="public-functions">Public Functions</h2>
<div class="table"><table class="alignedsummary">
<tr><td class="memItemLeft rightAlign topAlign"> </td><td class="memItemRight bottomAlign"><b><a href="sqlitedatabase.html#SQLiteDatabase">SQLiteDatabase</a></b>(QQuickItem *<i> parent</i> = 0)</td></tr>
<tr><td class="memItemLeft rightAlign topAlign"> void </td><td class="memItemRight bottomAlign"><b><a href="sqlitedatabase.html#bind">bind</a></b>(QString<i> key</i>, QVariant<i> value</i>)</td></tr>
<tr><td class="memItemLeft rightAlign topAlign"> void </td><td class="memItemRight bottomAlign"><b><a href="sqlitedatabase.html#close">close</a></b>()</td></tr>
<tr><td class="memItemLeft rightAlign topAlign"> bool </td><td class="memItemRight bottomAlign"><b><a href="sqlitedatabase.html#commit">commit</a></b>()</td></tr>
<tr><td class="memItemLeft rightAlign topAlign"> bool </td><td class="memItemRight bottomAlign"><b><a href="sqlitedatabase.html#create">create</a></b>(QString<i> filePath</i>)</td></tr>
<tr><td class="memItemLeft rightAlign topAlign"> QSqlDatabase &amp; </td><td class="memItemRight bottomAlign"><b><a href="sqlitedatabase.html#database">database</a></b>()</td></tr>
<tr><td class="memItemLeft rightAlign topAlign"> QString </td><td class="memItemRight bottomAlign"><b><a href="sqlitedatabase.html#databaseName">databaseName</a></b>()</td></tr>
<tr><td class="memItemLeft rightAlign topAlign"> bool </td><td class="memItemRight bottomAlign"><b><a href="sqlitedatabase.html#exec">exec</a></b>(QString<i> query</i> = QString())</td></tr>
<tr><td class="memItemLeft rightAlign topAlign"> bool </td><td class="memItemRight bottomAlign"><b><a href="sqlitedatabase.html#execBatch">execBatch</a></b>(QStringList<i> batch</i>, bool<i> ignoreErrors</i> = false)</td></tr>
<tr><td class="memItemLeft rightAlign topAlign"> QString </td><td class="memItemRight bottomAlign"><b><a href="sqlitedatabase.html#lastError">lastError</a></b>()</td></tr>
<tr><td class="memItemLeft rightAlign topAlign"> bool </td><td class="memItemRight bottomAlign"><b><a href="sqlitedatabase.html#open">open</a></b>()</td></tr>
<tr><td class="memItemLeft rightAlign topAlign"> bool </td><td class="memItemRight bottomAlign"><b><a href="sqlitedatabase.html#opened">opened</a></b>()</td></tr>
<tr><td class="memItemLeft rightAlign topAlign"> bool </td><td class="memItemRight bottomAlign"><b><a href="sqlitedatabase.html#prepare">prepare</a></b>(QString<i> query</i>)</td></tr>
<tr><td class="memItemLeft rightAlign topAlign"> Query * </td><td class="memItemRight bottomAlign"><b><a href="sqlitedatabase.html#queryx">query</a></b>()</td></tr>
<tr><td class="memItemLeft rightAlign topAlign"> bool </td><td class="memItemRight bottomAlign"><b><a href="sqlitedatabase.html#rollback">rollback</a></b>()</td></tr>
<tr><td class="memItemLeft rightAlign topAlign"> void </td><td class="memItemRight bottomAlign"><b><a href="sqlitedatabase.html#setDatabaseName">setDatabaseName</a></b>(const QString &amp;<i> name</i>)</td></tr>
<tr><td class="memItemLeft rightAlign topAlign"> bool </td><td class="memItemRight bottomAlign"><b><a href="sqlitedatabase.html#transaction">transaction</a></b>()</td></tr>
<tr><td class="memItemLeft rightAlign topAlign"> bool </td><td class="memItemRight bottomAlign"><b><a href="sqlitedatabase.html#valid">valid</a></b>()</td></tr>
</table></div>
<a name="signals"></a>
<h2 id="signals">Signals</h2>
<div class="table"><table class="alignedsummary">
<tr><td class="memItemLeft rightAlign topAlign"> void </td><td class="memItemRight bottomAlign"><b><a href="sqlitedatabase.html#databaseNameChanged">databaseNameChanged</a></b>()</td></tr>
<tr><td class="memItemLeft rightAlign topAlign"> void </td><td class="memItemRight bottomAlign"><b><a href="sqlitedatabase.html#openedChanged">openedChanged</a></b>()</td></tr>
<tr><td class="memItemLeft rightAlign topAlign"> void </td><td class="memItemRight bottomAlign"><b><a href="sqlitedatabase.html#queryChanged">queryChanged</a></b>()</td></tr>
</table></div>
<a name="details"></a>
<!-- $$$SQLiteDatabase-description -->
<div class="descr">
<h2 id="details">Detailed Description</h2>
<p>The <a href="sqlitedatabase.html">SQLiteDatabase</a> class</p>
<p>This class will act as a QML accessible database layer.</p>
<p>An example usage is as follows.</p>
<pre class="qml"><span class="type"><a href="sqlitedatabase.html#SQLiteDatabase">SQLiteDatabase</a></span> {
 <span class="name">onValidateDatabase</span>: {
     <span class="comment">//Check if this is an sql lite db</span>
     <span class="keyword">if</span>(<span class="name">opened</span>) <span class="name">close</span>()

     <span class="name">console</span>.<span class="name">debug</span>(<span class="string">&quot;opening db at &quot;</span> <span class="operator">+</span> <span class="name">filePath</span>)
     <span class="name">databaseName</span> <span class="operator">=</span> <span class="name">filePath</span>

     <span class="keyword">if</span>(!<span class="name">open</span>()) <span class="keyword">return</span> <span class="number">false</span>

     <span class="name">console</span>.<span class="name">debug</span>(<span class="string">&quot;running query on &quot;</span> <span class="operator">+</span> <span class="name">databaseName</span>)

     <span class="comment">//Check for a mnemosyne table for verification</span>

     var <span class="name">result</span> = <span class="name">exec</span>(<span class="string">&quot;SELECT * FROM table WHERE key='version' AND value='1.0';&quot;</span>)
     <span class="keyword">if</span>(!<span class="name">result</span>) {
         <span class="name">console</span>.<span class="name">error</span>(<span class="name">lastError</span>)
         <span class="name">validDb</span> <span class="operator">=</span> <span class="number">false</span>
     }
     <span class="name">console</span>.<span class="name">debug</span>(<span class="string">&quot;query was valid&quot;</span>)

     <span class="keyword">if</span>(<span class="name">query</span>.<span class="name">indexOf</span>(<span class="string">&quot;value&quot;</span>) <span class="operator">!==</span> -<span class="number">1</span>) <span class="name">initTrackingValues</span>()

     <span class="name">validDb</span> <span class="operator">=</span> <span class="name">result</span>
 }
}</pre>
<p>Back to <a href="index.html">Sailfish Widgets</a></p>
</div>
<!-- @@@SQLiteDatabase -->
<div class="func">
<h2>Member Function Documentation</h2>
<!-- $$$SQLiteDatabase[overload1]$$$SQLiteDatabaseQQuickItem* -->
<h3 class="fn" id="SQLiteDatabase"><a name="SQLiteDatabase"></a>SQLiteDatabase::<span class="name">SQLiteDatabase</span>(<span class="type">QQuickItem</span> *<i> parent</i> = 0)</h3>
<p>Sets the <i>parent</i>.</p>
<!-- @@@SQLiteDatabase -->
<!-- $$$bind[overload1]$$$bindQStringQVariant -->
<h3 class="fn" id="bind"><a name="bind"></a><span class="type">void</span> SQLiteDatabase::<span class="name">bind</span>(<span class="type">QString</span><i> key</i>, <span class="type">QVariant</span><i> value</i>)</h3>
<p>Binds the string <i>key</i> with the specified <i>value</i> to the last query.</p>
<!-- @@@bind -->
<!-- $$$close[overload1]$$$close -->
<h3 class="fn" id="close"><a name="close"></a><span class="type">void</span> SQLiteDatabase::<span class="name">close</span>()</h3>
<p>Closes the database. Emits the <code>openedChanged()</code> signal.</p>
<!-- @@@close -->
<!-- $$$commit[overload1]$$$commit -->
<h3 class="fn" id="commit"><a name="commit"></a><span class="type">bool</span> SQLiteDatabase::<span class="name">commit</span>()</h3>
<p>Ends an SQLite transaction. Returns true if successful.</p>
<!-- @@@commit -->
<!-- $$$create[overload1]$$$createQString -->
<h3 class="fn" id="create"><a name="create"></a><span class="type">bool</span> SQLiteDatabase::<span class="name">create</span>(<span class="type">QString</span><i> filePath</i>)</h3>
<p>Creates a new <a href="sqlitedatabase.html">SQLiteDatabase</a> at <i>filePath</i> and opens it.</p>
<p>Returns true if the database was succesfully opened.</p>
<p><b>See also </b><a href="sqlitedatabase.html#open">open</a>().</p>
<!-- @@@create -->
<!-- $$$database[overload1]$$$database -->
<h3 class="fn" id="database"><a name="database"></a><span class="type">QSqlDatabase</span> &amp; SQLiteDatabase::<span class="name">database</span>()</h3>
<p>Returns a reference to the internal SQLite database.</p>
<!-- @@@database -->
<!-- $$$databaseName[overload1]$$$databaseName -->
<h3 class="fn" id="databaseName"><a name="databaseName"></a><span class="type">QString</span> SQLiteDatabase::<span class="name">databaseName</span>()</h3>
<p>Returns the current database name.</p>
<p><b>See also </b><a href="sqlitedatabase.html#setDatabaseName">setDatabaseName</a>().</p>
<!-- @@@databaseName -->
<!-- $$$databaseNameChanged[overload1]$$$databaseNameChanged -->
<h3 class="fn" id="databaseNameChanged"><a name="databaseNameChanged"></a><code>[signal] </code><span class="type">void</span> SQLiteDatabase::<span class="name">databaseNameChanged</span>()</h3>
<p>Emitted when the database name has changed.</p>
<!-- @@@databaseNameChanged -->
<!-- $$$exec[overload1]$$$execQString -->
<h3 class="fn" id="exec"><a name="exec"></a><span class="type">bool</span> SQLiteDatabase::<span class="name">exec</span>(<span class="type">QString</span><i> query</i> = QString())</h3>
<p>Executes a QString <i>query</i>.</p>
<p>Returns true if successful. False otherwise.</p>
<p>Using an empty query will instead invoke the last query. This is mostly useful if you previously called the <code>prepare()</code> method and you need to execute it after added values with <code>bind()</code>.</p>
<p><b>See also </b><a href="sqlitedatabase.html#prepare">prepare</a>() and <a href="sqlitedatabase.html#bind">bind</a>().</p>
<!-- @@@exec -->
<!-- $$$execBatch[overload1]$$$execBatchQStringListbool -->
<h3 class="fn" id="execBatch"><a name="execBatch"></a><span class="type">bool</span> SQLiteDatabase::<span class="name">execBatch</span>(<span class="type">QStringList</span><i> batch</i>, <span class="type">bool</span><i> ignoreErrors</i> = false)</h3>
<p>Executes a <i>batch</i> of commands. Each command must be a single SQL statement, but need not to end with a semicolon.</p>
<p>Each statement is executed in succession until an error occurs, unless <i>ignoreErrors</i> is true in which case execBatch will continue until the end.</p>
<p>As a side note:</p>
<ul>
<li>Empty commands are ignored</li>
<li>Commands of<pre class="cpp"><span class="string">&quot;begin transaction&quot;</span></pre>
<p>or</p>
<pre class="cpp"><span class="string">&quot;commit&quot;</span></pre>
<p>will be converted into calls to <code>transaction</code> and <code>commit()</code> , respectively.</p>
</li>
</ul>
<p>This method will return true if completed succesfully. False, otherwise.</p>
<p><b>See also </b><a href="sqlitedatabase.html#exec">exec</a>(), <a href="sqlitedatabase.html#transaction">transaction</a>(), and <a href="sqlitedatabase.html#commit">commit</a>().</p>
<!-- @@@execBatch -->
<!-- $$$lastError[overload1]$$$lastError -->
<h3 class="fn" id="lastError"><a name="lastError"></a><span class="type">QString</span> SQLiteDatabase::<span class="name">lastError</span>()</h3>
<p>Returns the textual description of the last error that occurred.</p>
<!-- @@@lastError -->
<!-- $$$open[overload1]$$$open -->
<h3 class="fn" id="open"><a name="open"></a><span class="type">bool</span> SQLiteDatabase::<span class="name">open</span>()</h3>
<p>Opens the database. This requires that the database name be set.</p>
<p>Returns true if successful.</p>
<p><b>See also </b><a href="sqlitedatabase.html#setDatabaseName">setDatabaseName</a>().</p>
<!-- @@@open -->
<!-- $$$opened[overload1]$$$opened -->
<h3 class="fn" id="opened"><a name="opened"></a><span class="type">bool</span> SQLiteDatabase::<span class="name">opened</span>()</h3>
<p>Returns true if the database has been opened.</p>
<!-- @@@opened -->
<!-- $$$openedChanged[overload1]$$$openedChanged -->
<h3 class="fn" id="openedChanged"><a name="openedChanged"></a><code>[signal] </code><span class="type">void</span> SQLiteDatabase::<span class="name">openedChanged</span>()</h3>
<p>Emitted when the database's open state has changed.</p>
<!-- @@@openedChanged -->
<!-- $$$prepare[overload1]$$$prepareQString -->
<h3 class="fn" id="prepare"><a name="prepare"></a><span class="type">bool</span> SQLiteDatabase::<span class="name">prepare</span>(<span class="type">QString</span><i> query</i>)</h3>
<p>Prepares a boundable <i>query</i>.</p>
<p>Returns true if successful.</p>
<!-- @@@prepare -->
<!-- $$$query[overload1]$$$query -->
<h3 class="fn" id="queryx"><a name="queryx"></a><span class="type"><a href="query.html">Query</a></span> * SQLiteDatabase::<span class="name">query</span>()</h3>
<p>This method will return the last <a href="query.html">Query</a> object that was created using the <code>exec()</code> or <code>prepare()</code> methods.</p>
<p><b>Warning:</b> <a href="query.html">Query</a> objects will be deleted whenever you call a <code>exec()</code> or <code>prepare()</code>.</p>
<p>Therefore, you must not use the object returned from this method after executing a new SQL statement.</p>
<!-- @@@query -->
<!-- $$$queryChanged[overload1]$$$queryChanged -->
<h3 class="fn" id="queryChanged"><a name="queryChanged"></a><code>[signal] </code><span class="type">void</span> SQLiteDatabase::<span class="name">queryChanged</span>()</h3>
<p>Emitted when the last ran query has changed.</p>
<!-- @@@queryChanged -->
<!-- $$$rollback[overload1]$$$rollback -->
<h3 class="fn" id="rollback"><a name="rollback"></a><span class="type">bool</span> SQLiteDatabase::<span class="name">rollback</span>()</h3>
<p>Rolls back a database transaction.</p>
<p>This method will automatically invalidate the existing query.</p>
<p>Returns true if successful.</p>
<!-- @@@rollback -->
<!-- $$$setDatabaseName[overload1]$$$setDatabaseNameconstQString& -->
<h3 class="fn" id="setDatabaseName"><a name="setDatabaseName"></a><span class="type">void</span> SQLiteDatabase::<span class="name">setDatabaseName</span>(const <span class="type">QString</span> &amp;<i> name</i>)</h3>
<p>Sets the database name to <i>name</i>. You must do this before calling <code>open()</code>.</p>
<p>Emits the <code>databaseNameChanged()</code> signal</p>
<p><b>See also </b><a href="sqlitedatabase.html#databaseName">databaseName</a>() and <a href="sqlitedatabase.html#open">open</a>().</p>
<!-- @@@setDatabaseName -->
<!-- $$$transaction[overload1]$$$transaction -->
<h3 class="fn" id="transaction"><a name="transaction"></a><span class="type">bool</span> SQLiteDatabase::<span class="name">transaction</span>()</h3>
<p>Starts a new SQLite transaction.</p>
<p>Returns true if successful.</p>
<!-- @@@transaction -->
<!-- $$$valid[overload1]$$$valid -->
<h3 class="fn" id="valid"><a name="valid"></a><span class="type">bool</span> SQLiteDatabase::<span class="name">valid</span>()</h3>
<p>Returns true if the database file given is a valid SQLite database.</p>
<!-- @@@valid -->
</div>
</body>
</html>
